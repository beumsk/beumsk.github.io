<!DOCTYPE html><html lang="en"><head><script data-goatcounter="https://beumsk.goatcounter.com/count" data-goatcounter-settings="{&quot;no_onload&quot;: true}" async="" src="/scripts/goatcounter.js"></script><noscript><style type="text/css">
                [data-aos] {
                  opacity: 1 !important;
                  transform: translate(0) scale(1) !important;
                }
              </style></noscript><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta property="og:locale" content="en_GB"/><meta property="og:type" content="website"/><meta name="author" content="RÃ©my Beumier"/><meta property="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#009688"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><title>Get web analytics in Next.js with Goatcounter</title><meta name="description" content="How to track your Next.js web analytics without tracking of personal data with Goatcounter"/><meta property="og:title" content="Get web analytics in Next.js with Goatcounter"/><meta property="og:description" content="How to track your Next.js web analytics without tracking of personal data with Goatcounter"/><meta property="og:url" content="https://remybeumier.be/blog/get-web-analytics-in-nextjs-with-goatcounter"/><meta property="og:image" content="https://remybeumier.be/images/posts/get-web-analytics-in-nextjs-with-goatcounter.jpg"/><meta property="twitter:title" content="Get web analytics in Next.js with Goatcounter"/><meta property="twitter:description" content="How to track your Next.js web analytics without tracking of personal data with Goatcounter"/><meta property="twitter:url" content="https://remybeumier.be/blog/get-web-analytics-in-nextjs-with-goatcounter"/><meta property="twitter:image" content="https://remybeumier.be/images/posts/get-web-analytics-in-nextjs-with-goatcounter.jpg"/><meta property="article:published_time" content="2022-04-07"/><meta property="article:modified_time" content="2022-11-08"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/3ccc7a3e045f76df.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3ccc7a3e045f76df.css" data-n-g=""/><link rel="preload" href="/_next/static/css/db0d4378de7d1cb1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/db0d4378de7d1cb1.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-5752944655d749a0.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-101cfeaa18eb0e64.js" defer=""></script><script src="/_next/static/chunks/pages/_app-05e3e170aa94a7d9.js" defer=""></script><script src="/_next/static/chunks/252f366e-a6d3e1ca6d8065f9.js" defer=""></script><script src="/_next/static/chunks/d0447323-8a34f8a4596aec49.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-b60659924e273fff.js" defer=""></script><script src="/_next/static/chunks/d7eeaac4-89125e834a7325a0.js" defer=""></script><script src="/_next/static/chunks/417-a9472f6dbe220f36.js" defer=""></script><script src="/_next/static/chunks/136-77403b8a33c6482d.js" defer=""></script><script src="/_next/static/chunks/127-537464ba9f9338e9.js" defer=""></script><script src="/_next/static/chunks/pages/blog/get-web-analytics-in-nextjs-with-goatcounter-af0d542eecb6c14e.js" defer=""></script><script src="/_next/static/zpaPA0G-ZGm1QXEFEj7Je/_buildManifest.js" defer=""></script><script src="/_next/static/zpaPA0G-ZGm1QXEFEj7Je/_ssgManifest.js" defer=""></script><script src="/_next/static/zpaPA0G-ZGm1QXEFEj7Je/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main class="" itemscope="" itemType="http://schema.org/Article"><header class="header"><div class="container"><a class="logo" href="/#"><img src="/images/logo.svg" alt="RÃ©my Beumier logo" title="Home" width="30" height="30"/></a><a href="/projects">Projects</a><a href="/blog">Blog</a><a href="/#contact">Contact</a><button class="btn" title="Switch to dark mode" aria-label="Switch to dark mode"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" aria-labelledby="Light mode" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Light mode</title><path fill="none" d="M0 0h24v24H0z"></path><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"></path></svg></button></div></header><div class="over-h"><div class="breadcrumb"><div class="container"><ul><li><a href="/">Home</a></li><li><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"></path></svg><a href="/blog">blog</a></li><li><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"></path></svg>get web analytics in nextjs with goatcounter</li></ul></div></div><div class="container narrow post-shape"><div data-aos="fade-left"><article><h1 itemProp="headline name">Get web analytics in Next.js with Goatcounter</h1><img src="/images/posts/get-web-analytics-in-nextjs-with-goatcounter.jpg" alt="Get web analytics in Next.js with Goatcounter" width="300" height="150" class="post__img mb-5" itemProp="image"/><div class="space-between-x mb-10"><div class="post__categories"><a href="/blog?next.js"><span itemProp="articleSection">Next.js</span></a><a href="/blog?tutorial"><span itemProp="articleSection">Tutorial</span></a><a href="/blog?analytics"><span itemProp="articleSection">Analytics</span></a></div><div><time class="post__date" itemProp="datePublished" content="7.4.2022" dateTime="7.4.2022">Published on: <!-- -->7.4.2022</time><time class="post__date" itemProp="dateModified" content="8.11.2022" dateTime="8.11.2022">Modified on: <!-- -->8.11.2022</time></div></div><div class="post__content mb-10" itemProp="articleBody"><p>Next.js is more and more complete with the years and it adds features every other month. One feature that we want for our websites is analytics. Vercel, the company behind Next.js provides an analytics tool that seems very complete as long as we decide to host our site on their platform. But what are the options for those of us not willing to host on that site?</p>
<p>Of course, Google is one of the many options, but as I was searching I realised I could use a less famous approach that doesn&#x27;t track visitor&#x27;s personal data and which is very lightweight.</p>
<p>That solution is called GoatCounter. It is an open source web analytics platform aiming to offer easy to use and meaningful privacy-friendly web analytics.</p>
<blockquote>
<p>We will use the hosted service as it is free for non-commercial use. Feel free to go an extra step by self-hosting the service and don&#x27;t hesitate to make a donation.</p>
</blockquote>
<p>Let&#x27;s see how we can implement this tool with our SSG Next.js website! ðŸš€</p>
<h2>Create a GoatCounter account</h2>
<p>The first step is to create an account at <a href="https://goatcounter.com/signup" target="_blank">GoatCounter</a>.
The design is not the sexiest, but it is very functional and easy to understand.</p>
<p>We can reach our account at: <em>https://[my-code].goatcounter.com</em>. Make sure to replace <code>[my-code]</code> with your actual account code.</p>
<p>In the settings, we will be able to disable the analytics for certain IP addresses, especially, ours.
If needed, we can also delete some data, import some other data and manage many other settings.</p>
<p>The dashboard presents useful data about pages traffic, top referrers, visitors locations, browsers, devices, etc. The layout of this dashboard is editable.</p>
<p><img src="/images/content/goatcounter-example.png" alt="GoatCounter dashboard example"/></p>
<h2>Integrate GoatCounter inside Next.js</h2>
<p>In order to get the data into our dashboard, we need to link GoatCounter to our Next.js app.</p>
<h3>1. Download GoatCounter file</h3>
<p>We will download a version of the <a href="https://gc.zgo.at/count.js" target="_blank">GoatCounter code</a>.
We can add it under the <code>public/script</code> folder in our solution.</p>
<h3>2. Connect the app to GoatCounter.com</h3>
<p>GoatCounter needs to receive the info from our website, and we will create a connection inside <code>_document.js</code>. To be able to run some testing, there is an option to allow GoatCounter in your local solution. It is mentioned as a comment in the snippet below.</p>
<pre><code class="language-js">import Document, { Html, Head, Main, NextScript } from &#x27;next/document&#x27;;

class MyDocument extends Document {
  render() {
    return (
      &lt;Html lang=&quot;en&quot;&gt;
        &lt;Head&gt;
          {/* add &quot;allow_local&quot;: true to data-goatcounter-settings to test in local env */}
          &lt;script
            data-goatcounter=&quot;https://beumsk.goatcounter.com/count&quot;
            data-goatcounter-settings=&#x27;{&quot;no_onload&quot;: true}&#x27;
            async
            src=&quot;/scripts/goatcounter.js&quot;
          &gt;&lt;/script&gt;
        &lt;/Head&gt;
        &lt;body&gt;
          &lt;Main /&gt;
          &lt;NextScript /&gt;
        &lt;/body&gt;
      &lt;/Html&gt;
    );
  }
}

export default MyDocument;
</code></pre>
<p>You could experiment with Next.js Script component, but I somehow couldn&#x27;t make it work properly.</p>
<h3>3. Add the GoatCounter logic</h3>
<p>Inside <code>_app.js</code>, we need to use the <code>useEffect</code> trick seen in another tutorial to <a href="/blog/fix-the-window-is-not-defined-error">use the window object with Next</a>. That way we can inform GoatCounter about every route change it can count in its analytics.</p>
<pre><code class="language-js">import { useEffect } from &#x27;react&#x27;;
import { useRouter } from &#x27;next/router&#x27;;

export default function MyApp({ Component, pageProps }) {
  const router = useRouter();

  useEffect(() =&gt; {
    if (typeof window !== &#x27;undefined&#x27;) {
      window.goatcounter.count({
        path: router.asPath,
      });
    }
  }, [router]);

  return &lt;Component {...pageProps} /&gt;;
}
</code></pre>
<p>Reaching this point, we should have been able to test GoatCounter locally, and it should work once delivered on production.</p>
<blockquote>
<p>Keep in mind that ad blockers may interfere with GoatCounter</p>
</blockquote>
<p>I&#x27;m personally very satisfied so far with the service, as it allows me to check my site&#x27;s web analytics respecting visitor&#x27;s privacy with a very light script.</p>
<p>Enjoy coding with Next.js!</p></div><div class="mb-15"><a class="btn" href="/blog"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="mr-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M689 165.1L308.2 493.5c-10.9 9.4-10.9 27.5 0 37L689 858.9c14.2 12.2 35 1.2 35-18.5V183.6c0-19.7-20.8-30.7-35-18.5z"></path></svg>Back to blog listing</a></div><div><h2 class="mb-5">Suggested articles</h2><div class="grid mb-20"><div class="card"><div class="card__behind"><a class="card__title" title="Change Next.js error pages" href="/blog/change-nextjs-error-pages"><h2 class="t-ellipsis">Change Next.js error pages</h2></a></div><a title="Change Next.js error pages" tabindex="-1" href="/blog/change-nextjs-error-pages"><div class="card__img"><img src="/images/posts/change-nextjs-error-pages.jpg" alt="Change Next.js error pages" width="260" height="146" loading="lazy"/></div></a></div><div class="card"><div class="card__behind"><a class="card__title" title="Generate a sitemap in Next.js" href="/blog/generate-a-sitemap-in-nextjs"><h2 class="t-ellipsis">Generate a sitemap in Next.js</h2></a></div><a title="Generate a sitemap in Next.js" tabindex="-1" href="/blog/generate-a-sitemap-in-nextjs"><div class="card__img"><img src="/images/posts/generate-a-sitemap-in-nextjs.jpg" alt="Generate a sitemap in Next.js" width="260" height="146" loading="lazy"/></div></a></div></div></div></article></div></div></div><footer id="contact" class="contact over-h svg-divider"><div class="container" data-aos="fade-left"><p class="mb-5">Feel free to get in touch and stay connected with me via these different channels.</p><div class="mb-10"><a href="https://github.com/beumsk" target="_blank" rel="noopener noreferrer" class="btn mb-4 mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" aria-labelledby="Github" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Github</title><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span class="ml-1">Github</span></a><a href="https://codepen.io/beumsk/" target="_blank" rel="noopener noreferrer" class="btn mb-4 mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" aria-labelledby="Codepen" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Codepen</title><path d="M502.285 159.704l-234-156c-7.987-4.915-16.511-4.96-24.571 0l-234 156C3.714 163.703 0 170.847 0 177.989v155.999c0 7.143 3.714 14.286 9.715 18.286l234 156.022c7.987 4.915 16.511 4.96 24.571 0l234-156.022c6-3.999 9.715-11.143 9.715-18.286V177.989c-.001-7.142-3.715-14.286-9.716-18.285zM278 63.131l172.286 114.858-76.857 51.429L278 165.703V63.131zm-44 0v102.572l-95.429 63.715-76.857-51.429L234 63.131zM44 219.132l55.143 36.857L44 292.846v-73.714zm190 229.715L61.714 333.989l76.857-51.429L234 346.275v102.572zm22-140.858l-77.715-52 77.715-52 77.715 52-77.715 52zm22 140.858V346.275l95.429-63.715 76.857 51.429L278 448.847zm190-156.001l-55.143-36.857L468 219.132v73.714z"></path></svg><span class="ml-1">Codepen</span></a><a href="https://codesandbox.io/u/beumsk" target="_blank" rel="noopener noreferrer" class="btn mb-4 mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" aria-labelledby="Codesandbox" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Codesandbox</title><title></title><path d="M1.5 6l10.455-6L22.41 6l.09 11.95L11.955 24 1.5 18zm2.088 2.481v4.757l3.345 1.86v3.516l3.972 2.296v-8.272zm16.739 0l-7.317 4.157v8.272l3.972-2.296V15.1l3.345-1.861V8.48zM4.634 6.601l7.303 4.144 7.32-4.18-3.871-2.197-3.41 1.945-3.43-1.968L4.633 6.6z"></path></svg><span class="ml-1">Codesandbox</span></a><a href="https://www.linkedin.com/in/remybeumier/" target="_blank" rel="noopener noreferrer" class="btn mb-4 mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" aria-labelledby="LinkedIn" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg><span class="ml-1">LinkedIn</span></a></div><p class="contact__copy">Â© <!-- -->2023<!-- --> |<!-- --> <span itemProp="author" itemscope="" itemType="http://schema.org/Person"><span itemProp="name">RÃ©my Beumier</span></span></p></div></footer><div id="ie-banner">Please open this website with a recent browser for the best experience. Avoid Internet Explorer at all costs.</div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/get-web-analytics-in-nextjs-with-goatcounter","query":{},"buildId":"zpaPA0G-ZGm1QXEFEj7Je","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>